# 3.1 Лекция. Реляционная алгебра. Нормализация реляционных отношений.
# Модель данных <br>
•	 Определяет абстракцию данных для приложений. <br>
•	 Включает: <br>
•	 структуры данных; <br>
•	 операции; <br>
•	 зависимости; <br>
•	 ограничения. <br>
# Концептуальные модели данных <br>
•	 иерархическая; <br>
•	 сетевая; <br>
•	 реляционная; <br>
•	 объектно-реляционная. <br>
# Иерархическая модель данных <br>
ФАКУЛЬТЕТ - (Шифр_факультета, Название_факультета) <br>
КУРС - (Номер_курса) <br>
ГРУППА - (Номер_группы, Год_образования) <br>
СТУДЕНТ - (Номер_зачетной_книжки, ФИО_студента,Паспортные_данные) <br>
/ <br>
ФАКУЛЬТЕТ - (Шифр_факультета, Название_факультета) <br>
КАФЕДРА - (Шифр_кафедры,Название_кафедры) <br>
ПРЕПОДАВАТЕЛЬ - (ФИО_преподавателя,Должность,Паспортные_данные) <br>
# Реляционная модель <br>
•	 Первые публикации: 1969-1971 годы. <br>
•	 Интенсивное развитие теории: 1970-е годы. <br>
•	 Ранние попытки реализации: 1978 год. <br>
•	 Стандарт SQL: 1986 год. <br>
•	 Эффективные реализации SQL: 1990 год <br>
# Реляционная модели <br>
•	 Таблицы. <br>
•	 Столбцы – атрибуты. <br>
•	 Строки – данные. <br>
•	 Шапка таблицы – имена атрибутов. <br>
# Пример: представление данных в реляционной модели <br>
Номер зачетки ФИО студента Номер группы: <br>
45477 - Бусыгин Вячеслав - 441 <br>
44676 - Дубова Алина - 646 <br>
44674 - Зареков Михаил - 646 <br>
46575 - Федоров Никита  - 341 <br>
# Реляционная модель – структуры данных <br>
•	 Домены – множества, элементы которых <br>
рассматриваются как скалярные значения. <br>
•	 Отношения – предикаты, заданные <br>
на прямом произведении доменов. <br>
•	 Атрибуты – аргументы отношений. <br>
# Терминология <br>
•	 Экземпляр – конкретное наполнение базы данных. <br>
•	 Конкретное наполнение таблицы – тело отношения. <br>
•	 Совокупность атрибутов отношения – заголовок отношения (схема). <br>
•	 Заголовок + тело = значение отношения. <br>
•	 Строка таблицы – кортеж. <br>
# Типы данных атрибутов: <br>
•	 символьный; <br>
•	 битовый; <br>
•	 точные числа; <br>
•	 округленные числа; <br>
•	 денежный; <br>
•	 дата/время; <br>
•	 интервал. <br>
# Сущности <br>
• Сущности – таблицы. <br>
• Имя сущности – имя отношения. <br>
• Атрибут – столбец. <br>
• Уникальный идентификатор сущности – ключ отношения <br>
# Ключ <br>
• Возможный ключ – минимальный набор атрибутов, от которого функционально зависят все остальные. <br>
• Первичный ключ – один из возможных ключей. <br>
• Ключевые атрибуты – атрибуты, входящие в состав возможного ключа. <br>
# Связи <br>
• Связи хранятся в отношениях. <br>
• Схема отношения составляется из ключевых атрибутов объектов, участвующих в связи, и атрибутов самой связи (если такие есть). <br>
# «Плохие» отношения – пример 1: <br>
Группы <br>
Группа Список группы <br>
341 - (5556, Федоров Никита); (5677,Шпар Софья);(5674, Пашкова Мария);… <br>
441 - (4677, Бусыгин Вячеслав); (4645, Лучков Александр); (4536, Кривоносова Нина);… <br>
646 - (3788, Дубова Алина); (3745,Заречев Михаил); (3755,Черняев Андрей);… <br>
# «Плохие» отношения – пример 2: <br>
Товары и фирмы <br>
Название фирмы - Адрес ----- Телефон ---- Товар ---- Цена (руб.) <br>
Чижиков & Co Уткин проезд, 5 999-99-99 Винт большой 3 <br>
Чижиков & Co Уткин проезд, 5 999-99-99 Винт маленький 5 <br>
Винты-гайки Ул.Ленина, 1 333-33-33 Винт 4 <br>
Стройтовары Стройбаза № 1 444-44-44 Саморез 2 <br>
Чижиков & Co Уткин проезд, 5 999-99-99 Саморез 3 <br>
# Недостатки «плохих» отношений: <br>
• трудности с извлечением некоторых данных; <br>
• избыточность; <br>
• аномалии изменения; <br>
• аномалии удаления; <br>
• аномалии добавления. <br>
# Что плохого в таблице Товары и фирмы? <br>
В отношении Товары и фирмы: <br>
• Название фирмы → Адрес, Телефон; <br>
• Название фирмы, Товар → Цена. <br>
# Полная функциональная зависимость <br>
• Y полностью функционально зависит от X, если Y функционально зависит от всех атрибутов, входящих в состав X, а не от какой-то его части. <br>
• В отношении Товары и фирмы: <br>
• Название фирмы, Товар → Цена (полная функциональная зависимость); <br>
• Название фирмы, Товар → Адрес, Телефон (неполная функциональная зависимость). <br>
# Транзитивные зависимости <br>
Функциональная зависимость A→ C называется транзитивной, если существует такой атрибут B, что имеются функциональные зависимости A→ B и B→ C и отсутствует функциональная зависимость C→ A <br>
# Пример транзитивной зависимости <br>
Транзитивные функциональные зависимости в отношении Студенты и предметы: <br>
• Номер зачетки → Группа; <br>
• Группа, Предмет → Преподаватель. <br>
• Номер зачетки, Предмет → Группа, Предмет → Преподаватель. <br>
# Декомпозиция <br>
Декомпозиция – это разбиение на множества, возможно, пересекающиеся, такие, что их объединение – это исходное отношение <br>
# 1 НФ <br>
• 1-я	нормальная	форма	(НФ)	–	атрибуты отношения не	являются	составными. <br>
Нарушения 1 НФ: <br>
• Фирма,	{Город,	Улица,	Дом},	Товар. <br>
• Имя	{Телефон1,	Телефон2…}.	<br>
# 2 НФ <br>
• 2-я нормальная форма = 1 НФ + любой атрибут, не являющийся первичным, полностью зависит от любого его ключа, но не от подмножества ключа. <br>
• Атрибут	называется	первичным,	если	входит в	состав	любого	возможного	ключа. <br>
# Пример: 2 НФ <br>
Т(Универмаг, Товар, Номер отдела, Заведующий) <br>
Зависимости: <br>
Универмаг, Товар → Номер отдела <br>
Универмаг, Номер отдела → Заведующий <br>
Ключ: (Универмаг, Товар) <br>
2 НФ выполнена. <br>
Т(Фирма, Адрес, Телефон, Товар, Цена) <br>
Ключ: (Фирма, Товар) <br>
Зависимости: Фирма → Адрес, Телефон <br>
2 НФ нарушена. <br>
# 3 НФ <br>
• A,	B,	C	–	атрибуты,	A	→	B,	B	→	C, A	не	зависит	от	B	и	B	не	зависит	от	C. <br>
Тогда	говорят,	что	C	транзитивно зависит	от	A. <br>
• 3	нормальная	форма	=	2	НФ	+	любой атрибут, не	являющийся	первичным, нетранзитивно зависит	от	любого возможного	ключа. <br>
# Пример: 3 НФ <br>
Т(Город,	Индекс,	Адрес) <br>
Зависимости: <br>
Город,	Адрес	→	Индекс, Индекс	→	Город <br>
Ключ:	(Город,	Адрес)	или	(Индекс,	Адрес) <br>
3 НФ выполнена. <br>
Т(Универмаг, Товар, Номер отдела, Заведующий) <br>
Зависимости: <br>
Универмаг, Товар → Номер отдела УТ <br>
Универмаг, Номер отдела → Заведующий <br>
Ключ: (Универмаг, Товар). <br>
2 НФ выполнена, но 3 НФ нарушена. <br>
# НФ Бойса-Кодда <br>
Нормальная форма	Бойса-Кодда	–	 детерминанты (левая часть) всех функциональных зависимостей являются потенциальными ключами <br>
# Пример: НФ Бойса-Кодда <br>
Т(Город,	Индекс,	Адрес) <br>
Ключ: (Город, Адрес) или (Индекс, Адрес) <br>
Зависимости: <br>
Город,	Адрес	→	Индекс <br>
Индекс	→	Город <br>
2 и 3 НФ выполнены, НФ Бойса-Кодда нарушена <br>
# Выводы: <br>
• Отношение может быть приведено к 3 НФ с сохранением всех функциональных зависимостей. <br>
• Отношение может быть приведено к НФ Бойса–Кодда, но некоторые функциональные зависимости могут быть потеряны. <br>
# Шаги при декомпозиции <br>
1	 Находим минимальное покрытие множества функциональных зависимостей. <br>
2	 Выделяем	зависимость X → Y,	нарушающую	нормальную форму (и	нет	атрибутов,	зависящих	от	Y). <br>
3	 Находим зависимости с такой же левой частью. X → W, X → Z <br>
4	 Выделяем в отдельное отношение XYWZ. <br>
5	 Из исходного отношения удаляем YWZ. <br>
